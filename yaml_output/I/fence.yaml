# yaml-language-server: $schema=../../../schemas/inst_schema.json

fence:
  long_name: Enforce ordering between memory operations
  description: |
      Ensures that all memory accesses and I/O operations issued before the
    FENCE instruction are completed before any memory accesses or I/O operations after
    the FENCE are issued. This instruction is crucial in multicore and multiprocessor
    systems for enforcing memory ordering. FENCE is used to create synchronization
    points in code, ensuring that all memory operations are visible to other cores
    or devices in a specific order. It's particularly important in implementing lock-free
    algorithms, in managing shared memory between cores, and in ensuring proper ordering
    of memory accesses with respect to memory-mapped I/O operations. FENCE can have
    different variants to specify which types of operations (reads, writes, I/O) need
    to be ordered.
  definedBy: [I]
  assembly: fm, pred, succ, xs1, xd
  encoding:
    match: -----------------000-----0001111
    variables:
    - name: fm
      location: 31-28
      start-bit: 31
      end_bit: 28
    - name: pred
      location: 27-24
      start-bit: 27
      end_bit: 24
    - name: succ
      location: 23-20
      start-bit: 23
      end_bit: 20
    - name: rs1
      location: 19-15
      start-bit: 19
      end_bit: 15
    - name: rd
      location: 11-7
      start-bit: 11
      end_bit: 7
  access:
    s: ''
    u: ''
    vs: ''
    vu: ''
  pseudoinstructions:
  - when: fm==1000, pred==0011, succ==0011
    to: fence.tso xs1, xd
  - when: rs1==00000, fm==0000, pred==0001, rd==00000, succ==0000
    to: pause pause
  operation(): |
      
